#include <bits/stdc++.h>
#define INF INT_MAX
#define MINF INT_MIN
#define ll long long
#define ld long double
#define PB push_back
#define PF push_front
#define P_F pop_front
#define P_B pop_back
#define F front
#define B back
#define f first
#define s second
#define MP make_pair
#define FOR(i, a, b) for(ll i = a; i < b; i++)
#define FORI(i, a, b) for(ll i = a; i >= b; i--)

using namespace std;

bool nmayor(string &bef, string &x){
  if(x.size() > bef.size()) return false;
  if(x.size() < bef.size()) return true;
  return x <= bef;
}

int main(){
  ios_base::sync_with_stdio(false);
  cin.tie(NULL);
  int t, n, ans, maxi, ax, mini;
  string bef, x;
  bool gr, mn;
  cin >> t;
  
  FOR(ab, 0, t){
    cout << "Case #" << ab + 1 << ": ";
    cin >> n;
    vector<string> p(n);
    FOR(i, 0, n) cin >> p[i];
    
    bef = p[0];
    ans = 0;
    
    FOR(i, 1, n){
      x = p[i];
      maxi = max(x.size(), bef.size());
      mini = min(x.size(), bef.size());
      
      if(nmayor(bef, x)){
        ax = maxi - x.size();
        FOR(j, 0, ax) x.PB('0');
        
        gr = mn = false;
        FOR(j, 0, mini){
          if(x[j] > bef[j]){
            gr = true;
            break;
          }else if(x[j] < bef[j]){
            mn = true;
            break;
          }
        }
        
        ans += maxi - mini;
        if(!gr or mn){
          
          if(mn){
            x.PB('0');
            ans++;
          }
          else if(!gr){
            FORI(j, maxi - 1, mini){
              if(gr) x[j] = bef[j];
              else if(bef[j] != '9'){
                gr = true;
                x[j] = bef[j] + 1;
              }
            }
            
            if(!gr){
              x.PB('0');
              ans++;
            }
          }
        }
      }
      
      bef = x;
    }
    
    cout << ans << "\n";
  }

  return 0;
}